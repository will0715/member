{"version":3,"sources":["components/RecordDateRangeSearch.js","views/reports/ChopsConsume/Header.js","views/reports/ChopsConsume/index.js","hooks/useIsMountedRef.js","utils/analytics.js","components/Page.js","services/reportService.js"],"names":["RecordDateRangeSearch","restProps","language","useTranslation","i18n","getLocale","useMemo","zhTW","zhCN","enUS","editableDateInputs","dateDisplayFormat","locale","useStyles","makeStyles","theme","root","action","marginBottom","spacing","marginLeft","actionIcon","marginRight","Header","className","searchRange","handleSelect","reloadData","rest","classes","t","start","end","React","useState","open","setOpen","handleClose","Grid","clsx","container","justify","item","Breadcrumbs","separator","fontSize","aria-label","Link","variant","color","to","component","RouterLink","Typography","Button","onClick","SvgIcon","format","Dialog","onClose","aria-labelledby","aria-describedby","ranges","startDate","toDate","endDate","key","minDate","moment","add","maxDate","onChange","DialogActions","autoFocus","backgroundColor","palette","background","dark","minHeight","paddingTop","paddingBottom","ChopsConsume","needLoad","setNeedLoad","record","setRecord","startTime","setStartTime","endTime","setEndTime","useEffect","a","reportService","chopsConsume","data","fetch","columns","title","field","render","rowData","member","first_name","last_name","branch","name","code","type","Page","Container","maxWidth","selection","Box","mt","options","pageSize","pageSizeOptions","useIsMountedRef","isMounted","useRef","current","track","window","gtag","pageview","props","process","REACT_APP_GA_MEASUREMENT_ID","event","forwardRef","ref","children","location","useLocation","sendPageViewEvent","useCallback","page_path","pathname","Helmet","dashboard","axios","get","prepaidcardTopup","query","prepaidcardPayment","chopsAdd","transactions","memberRegisterBranchDetail","memberRegisterBranchStatistics"],"mappings":"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","file":"static/js/35.2d78ce06.chunk.js","sourcesContent":["import React, { useMemo } from 'react';\nimport { DateRange } from 'react-date-range';\nimport { useTranslation } from 'react-i18next';\nimport { zhTW, zhCN, enUS } from 'react-date-range/dist/locale';\n\nconst RecordDateRangeSearch = ({ ...restProps }) => {\n  const { i18n } = useTranslation();\n  const { language } = i18n;\n\n  const getLocale = useMemo(() => {\n    switch (language) {\n      case 'zh-TW':\n        return zhTW;\n      case 'zh-CN':\n        return zhCN;\n      default:\n        return enUS;\n    }\n  }, [language]);\n\n  return (\n    <DateRange\n      editableDateInputs={true}\n      dateDisplayFormat=\"yyyy-MM-dd\"\n      locale={getLocale}\n      {...restProps}\n    />\n  );\n};\n\nexport default RecordDateRangeSearch;\n","import React from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport {\n  Box,\n  Breadcrumbs,\n  Button,\n  Grid,\n  Link,\n  SvgIcon,\n  Typography,\n  makeStyles\n} from '@material-ui/core';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\nimport { Calendar as CalendarIcon } from 'react-feather';\nimport { useTranslation } from 'react-i18next';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport moment from 'moment';\nimport RecordDateRangeSearch from '../../../components/RecordDateRangeSearch';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {},\n  action: {\n    marginBottom: theme.spacing(1),\n    '& + &': {\n      marginLeft: theme.spacing(1)\n    }\n  },\n  actionIcon: {\n    marginRight: theme.spacing(1)\n  }\n}));\n\nfunction Header({ className, searchRange, handleSelect, reloadData, ...rest }) {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const { start, end } = searchRange;\n  const [open, setOpen] = React.useState(false);\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n    reloadData();\n  };\n\n  return (\n    <Grid\n      className={clsx(classes.root, className)}\n      container\n      justify=\"space-between\"\n      spacing={3}\n      {...rest}\n    >\n      <Grid item>\n        <Breadcrumbs separator={<NavigateNextIcon fontSize=\"small\" />} aria-label=\"breadcrumb\">\n          <Link variant=\"body1\" color=\"inherit\" to=\"/\" component={RouterLink}>\n            {t('Dashboard')}\n          </Link>\n          <Typography variant=\"body1\" color=\"textPrimary\">\n            {t('Chops Consume Report')}\n          </Typography>\n        </Breadcrumbs>\n        <Typography variant=\"h3\" color=\"textPrimary\">\n          {t('Chops Consume Report')}\n        </Typography>\n      </Grid>\n      <Grid item>\n        <Button\n          color=\"secondary\"\n          variant=\"contained\"\n          className={classes.action}\n          onClick={handleClickOpen}\n        >\n          <SvgIcon fontSize=\"small\" className={classes.actionIcon}>\n            <CalendarIcon />\n          </SvgIcon>\n          {start.format('YYYY-MM-DD')} ~ {end.format('YYYY-MM-DD')}\n        </Button>\n      </Grid>\n      <Dialog\n        open={open}\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <RecordDateRangeSearch\n          ranges={[\n            {\n              startDate: start.toDate(),\n              endDate: end.toDate(),\n              key: 'selection'\n            }\n          ]}\n          minDate={moment()\n            .add('-1', 'years')\n            .toDate()}\n          maxDate={moment().toDate()}\n          onChange={handleSelect}\n        />\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\" autoFocus>\n            OK\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Grid>\n  );\n}\n\nHeader.propTypes = {\n  className: PropTypes.string\n};\n\nexport default Header;\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport MaterialTable from 'material-table';\nimport Page from '../../../components/Page';\nimport reportService from '../../../services/reportService';\nimport { TextField } from '@material-ui/core';\nimport { Container, Box, IconButton, SvgIcon, makeStyles } from '@material-ui/core';\nimport { Edit as EditIcon, ArrowRight as ArrowRightIcon, Trash } from 'react-feather';\nimport useIsMountedRef from '../../../hooks/useIsMountedRef';\nimport { useTranslation } from 'react-i18next';\nimport { DateRange } from 'react-date-range';\nimport Header from './Header';\nimport moment from 'moment';\n// import Results from './Results';\nimport 'react-date-range/dist/styles.css'; // main style file\nimport 'react-date-range/dist/theme/default.css'; // theme css file\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    minHeight: '100%',\n    paddingTop: theme.spacing(3),\n    paddingBottom: theme.spacing(3)\n  }\n}));\n\nexport default function ChopsConsume() {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const [needLoad, setNeedLoad] = useState(true);\n  const [record, setRecord] = useState();\n  const [startTime, setStartTime] = useState(moment().add(-1, 'months'));\n  const [endTime, setEndTime] = useState(moment());\n\n  useEffect(() => {\n    async function fetch() {\n      const data = await reportService.chopsConsume({\n        start: startTime.format('YYYY-MM-DD'),\n        end: endTime.format('YYYY-MM-DD')\n      });\n      setRecord(data.data.data);\n    }\n    if (needLoad) {\n      fetch();\n      setNeedLoad(false);\n    }\n  }, [needLoad]);\n\n  const reloadData = () => {\n    setNeedLoad(true);\n  };\n\n  const handleSelect = (ranges) => {\n    const { selection } = ranges;\n    const { startDate, endDate } = selection;\n    // if (startDate == startTime && endTime == endDate)\n    setStartTime(moment(startDate));\n    setEndTime(moment(endDate));\n  };\n\n  const columns = [\n    {\n      title: t('Member'),\n      field: 'branch',\n      render: (rowData) => `${rowData.member.first_name} ${rowData.member.last_name}`\n    },\n    {\n      title: t('Branch'),\n      field: 'branch',\n      render: (rowData) => `${rowData.branch.name}(${rowData.branch.code})`\n    },\n    {\n      title: t('Type'),\n      field: 'type',\n      render: (rowData) => t(`ChopsType.${rowData.type}`)\n    },\n    {\n      title: t('Time'),\n      field: 'created_at'\n    },\n    {\n      title: t('Consume Chops'),\n      field: 'consume_chops'\n    }\n  ];\n\n  return (\n    <Page className={classes.root} title={t('Chops Consume Report')}>\n      <Container maxWidth={false}>\n        <Header\n          searchRange={{\n            start: startTime,\n            end: endTime\n          }}\n          handleSelect={handleSelect}\n          reloadData={reloadData}\n        />\n        {record && (\n          <Box mt={3}>\n            <MaterialTable\n              title={t('Chops Consume Report')}\n              options={{\n                pageSize: 15,\n                pageSizeOptions: [15, 30, 50]\n              }}\n              columns={columns}\n              data={record}\n            />\n          </Box>\n        )}\n      </Container>\n    </Page>\n  );\n}\n","import { useRef, useEffect } from 'react';\n\nexport default function useIsMountedRef() {\n  const isMounted = useRef(true);\n\n  useEffect(() => () => {\n    isMounted.current = false;\n  }, []);\n\n  return isMounted;\n}\n","function track(...args) {\n  if (process.env.NODE_ENV !== 'production') {\n    return;\n  }\n\n  if (!window.gtag) {\n    return;\n  }\n\n  window.gtag(...args);\n}\n\nfunction pageview(props) {\n  track('config', process.env.REACT_APP_GA_MEASUREMENT_ID, props);\n}\n\nfunction event(type, props) {\n  track('event', type, props);\n}\n\nexport default {\n  pageview,\n  event\n};\n","import React, { forwardRef, useEffect, useCallback } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { useLocation } from 'react-router';\nimport PropTypes from 'prop-types';\nimport track from '../utils/analytics';\n\nconst Page = forwardRef(({ title, children, ...rest }, ref) => {\n  const location = useLocation();\n\n  const sendPageViewEvent = useCallback(() => {\n    track.pageview({\n      page_path: location.pathname\n    });\n  }, [location]);\n\n  useEffect(() => {\n    sendPageViewEvent();\n  }, [sendPageViewEvent]);\n\n  return (\n    <div ref={ref} {...rest}>\n      <Helmet>\n        <title>{title}</title>\n      </Helmet>\n      {children}\n    </div>\n  );\n});\n\nPage.propTypes = {\n  children: PropTypes.node,\n  title: PropTypes.string\n};\n\nexport default Page;\n","import axios from '../utils/axios';\n\nclass ReportService {\n  dashboard = async () => {\n    const record = await axios.get('/api/v1/report/dashboard');\n    return record;\n  };\n\n  prepaidcardTopup = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/prepaidcards/topup?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  prepaidcardPayment = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/prepaidcards/payment?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  chopsAdd = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/chops/add?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  chopsConsume = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/chops/consume?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  transactions = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/transactions?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  memberRegisterBranchDetail = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/memberRegisterBranch/detail?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  memberRegisterBranchStatistics = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/memberRegisterBranch/statistics?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n}\n\nconst reportService = new ReportService();\n\nexport default reportService;\n"],"sourceRoot":""}