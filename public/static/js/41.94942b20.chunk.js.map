{"version":3,"sources":["views/reports/Transaction/Header.js","views/reports/Transaction/index.js","hooks/useIsMountedRef.js","utils/analytics.js","components/Page.js","services/reportService.js"],"names":["useStyles","makeStyles","theme","root","action","marginBottom","spacing","marginLeft","actionIcon","marginRight","Header","className","searchRange","handleSelect","reloadData","rest","classes","t","useTranslation","start","end","React","useState","open","setOpen","handleClose","Grid","clsx","container","justify","item","Breadcrumbs","separator","fontSize","aria-label","Link","variant","color","to","component","RouterLink","Typography","Button","onClick","SvgIcon","format","Dialog","onClose","aria-labelledby","aria-describedby","showMonthAndYearPickers","dateDisplayFormat","ranges","startDate","toDate","endDate","key","minDate","moment","add","maxDate","onChange","DialogActions","autoFocus","backgroundColor","palette","background","dark","minHeight","paddingTop","paddingBottom","Transaction","needLoad","setNeedLoad","record","setRecord","startTime","setStartTime","endTime","setEndTime","useEffect","a","reportService","transactions","data","fetch","columns","title","field","render","rowData","member","first_name","last_name","branch","name","code","payment_type","status","Page","Container","maxWidth","selection","Box","mt","options","pageSize","pageSizeOptions","useIsMountedRef","isMounted","useRef","current","track","window","gtag","pageview","props","process","REACT_APP_GA_MEASUREMENT_ID","event","type","forwardRef","ref","children","location","useLocation","sendPageViewEvent","useCallback","page_path","pathname","Helmet","dashboard","axios","get","prepaidcardTopup","query","prepaidcardPayment","chopsAdd","chopsConsume","memberRegisterBranchDetail","memberRegisterBranchStatistics"],"mappings":"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","file":"static/js/41.94942b20.chunk.js","sourcesContent":["import React from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport {\n  Box,\n  Breadcrumbs,\n  Button,\n  Grid,\n  Link,\n  SvgIcon,\n  Typography,\n  makeStyles\n} from '@material-ui/core';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\nimport { Calendar as CalendarIcon } from 'react-feather';\nimport { useTranslation } from 'react-i18next';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport { DateRange } from 'react-date-range';\nimport moment from 'moment';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {},\n  action: {\n    marginBottom: theme.spacing(1),\n    '& + &': {\n      marginLeft: theme.spacing(1)\n    }\n  },\n  actionIcon: {\n    marginRight: theme.spacing(1)\n  }\n}));\n\nfunction Header({ className, searchRange, handleSelect, reloadData, ...rest }) {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const { start, end } = searchRange;\n  const [open, setOpen] = React.useState(false);\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n    reloadData();\n  };\n\n  return (\n    <Grid\n      className={clsx(classes.root, className)}\n      container\n      justify=\"space-between\"\n      spacing={3}\n      {...rest}\n    >\n      <Grid item>\n        <Breadcrumbs separator={<NavigateNextIcon fontSize=\"small\" />} aria-label=\"breadcrumb\">\n          <Link variant=\"body1\" color=\"inherit\" to=\"/\" component={RouterLink}>\n            {t('Dashboard')}\n          </Link>\n          <Typography variant=\"body1\" color=\"textPrimary\">\n            {t('Transaction Report')}\n          </Typography>\n        </Breadcrumbs>\n        <Typography variant=\"h3\" color=\"textPrimary\">\n          {t('Transaction Report')}\n        </Typography>\n      </Grid>\n      <Grid item>\n        <Button\n          color=\"secondary\"\n          variant=\"contained\"\n          className={classes.action}\n          onClick={handleClickOpen}\n        >\n          <SvgIcon fontSize=\"small\" className={classes.actionIcon}>\n            <CalendarIcon />\n          </SvgIcon>\n          {start.format('YYYY-MM-DD')} ~ {end.format('YYYY-MM-DD')}\n        </Button>\n      </Grid>\n      <Dialog\n        open={open}\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DateRange\n          showMonthAndYearPickers={false}\n          dateDisplayFormat=\"yyyy-MM-dd\"\n          ranges={[\n            {\n              startDate: start.toDate(),\n              endDate: end.toDate(),\n              key: 'selection'\n            }\n          ]}\n          minDate={moment()\n            .add('-1', 'years')\n            .toDate()}\n          maxDate={moment().toDate()}\n          onChange={handleSelect}\n        />\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\" autoFocus>\n            OK\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Grid>\n  );\n}\n\nHeader.propTypes = {\n  className: PropTypes.string\n};\n\nexport default Header;\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport MaterialTable from 'material-table';\nimport Page from '../../../components/Page';\nimport reportService from '../../../services/reportService';\nimport { TextField } from '@material-ui/core';\nimport { Container, Box, IconButton, SvgIcon, makeStyles } from '@material-ui/core';\nimport { Edit as EditIcon, ArrowRight as ArrowRightIcon, Trash } from 'react-feather';\nimport useIsMountedRef from '../../../hooks/useIsMountedRef';\nimport { useTranslation } from 'react-i18next';\nimport { DateRange } from 'react-date-range';\nimport Header from './Header';\nimport moment from 'moment';\n// import Results from './Results';\nimport 'react-date-range/dist/styles.css'; // main style file\nimport 'react-date-range/dist/theme/default.css'; // theme css file\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    minHeight: '100%',\n    paddingTop: theme.spacing(3),\n    paddingBottom: theme.spacing(3)\n  }\n}));\n\nexport default function Transaction() {\n  const classes = useStyles();\n  const { t } = useTranslation();\n  const [needLoad, setNeedLoad] = useState(true);\n  const [record, setRecord] = useState();\n  const [startTime, setStartTime] = useState(moment().add(-1, 'months'));\n  const [endTime, setEndTime] = useState(moment());\n\n  useEffect(() => {\n    async function fetch() {\n      const data = await reportService.transactions({\n        start: startTime.format('YYYY-MM-DD'),\n        end: endTime.format('YYYY-MM-DD')\n      });\n      setRecord(data.data.data);\n    }\n    if (needLoad) {\n      fetch();\n      setNeedLoad(false);\n    }\n  }, [needLoad]);\n\n  const reloadData = () => {\n    setNeedLoad(true);\n  };\n\n  const handleSelect = (ranges) => {\n    const { selection } = ranges;\n    const { startDate, endDate } = selection;\n    // if (startDate == startTime && endTime == endDate)\n    setStartTime(moment(startDate));\n    setEndTime(moment(endDate));\n  };\n\n  const columns = [\n    {\n      title: t('Member'),\n      field: 'branch',\n      render: (rowData) => `${rowData.member.first_name} ${rowData.member.last_name}`\n    },\n    {\n      title: t('Branch'),\n      field: 'branch',\n      render: (rowData) => `${rowData.branch.name}(${rowData.branch.code})`\n    },\n    {\n      title: t('Payment Type'),\n      field: 'payment_type',\n      render: (rowData) => t(`PaymentType.${rowData.payment_type}`)\n    },\n    {\n      title: t('Clerk'),\n      field: 'clerk'\n    },\n    {\n      title: t('Items Count'),\n      field: 'items_count'\n    },\n    {\n      title: t('Amount'),\n      field: 'amount'\n    },\n    {\n      title: t('Transaction time'),\n      field: 'transaction_time'\n    },\n    {\n      title: t('Status'),\n      field: 'status',\n      render: (rowData) => t(`TransactionStatus.${rowData.status}`)\n    }\n  ];\n\n  return (\n    <Page className={classes.root} title={t('Transaction Report')}>\n      <Container maxWidth={false}>\n        <Header\n          searchRange={{\n            start: startTime,\n            end: endTime\n          }}\n          handleSelect={handleSelect}\n          reloadData={reloadData}\n        />\n        {record && (\n          <Box mt={3}>\n            <MaterialTable\n              title={t('Transaction Report')}\n              options={{\n                pageSize: 15,\n                pageSizeOptions: [15, 30, 50]\n              }}\n              columns={columns}\n              data={record}\n            />\n          </Box>\n        )}\n      </Container>\n    </Page>\n  );\n}\n","import { useRef, useEffect } from 'react';\n\nexport default function useIsMountedRef() {\n  const isMounted = useRef(true);\n\n  useEffect(() => () => {\n    isMounted.current = false;\n  }, []);\n\n  return isMounted;\n}\n","function track(...args) {\n  if (process.env.NODE_ENV !== 'production') {\n    return;\n  }\n\n  if (!window.gtag) {\n    return;\n  }\n\n  window.gtag(...args);\n}\n\nfunction pageview(props) {\n  track('config', process.env.REACT_APP_GA_MEASUREMENT_ID, props);\n}\n\nfunction event(type, props) {\n  track('event', type, props);\n}\n\nexport default {\n  pageview,\n  event\n};\n","import React, { forwardRef, useEffect, useCallback } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { useLocation } from 'react-router';\nimport PropTypes from 'prop-types';\nimport track from '../utils/analytics';\n\nconst Page = forwardRef(({ title, children, ...rest }, ref) => {\n  const location = useLocation();\n\n  const sendPageViewEvent = useCallback(() => {\n    track.pageview({\n      page_path: location.pathname\n    });\n  }, [location]);\n\n  useEffect(() => {\n    sendPageViewEvent();\n  }, [sendPageViewEvent]);\n\n  return (\n    <div ref={ref} {...rest}>\n      <Helmet>\n        <title>{title}</title>\n      </Helmet>\n      {children}\n    </div>\n  );\n});\n\nPage.propTypes = {\n  children: PropTypes.node,\n  title: PropTypes.string\n};\n\nexport default Page;\n","import axios from '../utils/axios';\n\nclass ReportService {\n  dashboard = async () => {\n    const record = await axios.get('/api/v1/report/dashboard');\n    return record;\n  };\n\n  prepaidcardTopup = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/prepaidcards/topup?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  prepaidcardPayment = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/prepaidcards/payment?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  chopsAdd = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/chops/add?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  chopsConsume = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/chops/consume?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  transactions = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/transactions?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  memberRegisterBranchDetail = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/memberRegisterBranch/detail?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n\n  memberRegisterBranchStatistics = async (query) => {\n    const record = await axios.get(\n      `/api/v1/report/memberRegisterBranch/statistics?start=${query.start}&end=${query.end}`\n    );\n    return record;\n  };\n}\n\nconst reportService = new ReportService();\n\nexport default reportService;\n"],"sourceRoot":""}